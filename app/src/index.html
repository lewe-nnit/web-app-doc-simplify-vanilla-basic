<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document Simplification Assistant</title>
  
  <link rel="stylesheet" href="styles.css" />
  
</head>
<body>
  <header>
    <div class="header-content">
      <h1>Document Simplification Assistant</h1>
      <img
        class="logo"
        src="https://cdn.cookielaw.org/logos/73c0b691-1f7b-41f9-995c-8d65c207b114/018ec1b4-1a78-7447-91d5-692cdcff97fa/8c4f46df-7539-4141-b4fb-5ac8f4685d0c/FERRING_Logo_RGB-R0-G136-B206.png"
        alt="Ferring Pharmaceuticals logo"
      />
    </div>
  </header>

  <main class="app-container">
    <nav class="sidebar" aria-label="Primary">
      <button class="menu-btn active" type="button">SOP Search</button>
      <button class="menu-btn" type="button" onclick="window.location.href='SOP_Mapper.html'">
        SOP Mapper
      </button>
      <button class="menu-btn" type="button" onclick="window.location.href='SOP_Evaluator.html'">
        SOP Meta Evaluator
      </button>
      <button class="menu-btn" type="button" onclick="window.location.href='SOP_Modernizer.html'">
        SOP Modernizer
      </button>
    </nav>

    <section class="main-panel">
      <div class="chat-output" role="region" aria-live="polite">
        <p><strong>Welcome to the Document Simplification Search Assistant.</strong></p>
        <p>Type in what you are looking for, e.g.:</p>
        <p>“I’m looking for information related to …”</p>
        <p>or</p>
        <p>“What documents are related to: Audit Management?”</p>
      </div>

      <form class="search-row" aria-label="Search SOPs">
        <input type="text" id="searchInput" name="search" placeholder="Type your search message here" />
        <button type="submit">Search</button>
      </form>
    </section>
  </main>

  <script>
    document.querySelector(".search-row").addEventListener("submit", async (e) => {
      e.preventDefault();
      const message = document.getElementById("searchInput").value.trim();
      if (!message) return alert("Please enter a search term.");

      // Build request body
      const body = JSON.stringify({ userChatMessage: message });

      try {
        const resp = await fetch("/api/documents_search", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body
        });

        if (!resp.ok) {
          const txt = await resp.text();
          alert(`Function error (${resp.status}): ${txt}`);
          return;
        }

        // Read JSON response
        const result = await resp.json();

        // Display result in your chat output container
        const output = document.querySelector(".chat-output");
        output.innerHTML = `<p><strong>Response:</strong> ${result.response || result}</p>`;
      } catch (err) {
        console.error("Call failed", err);
        alert("Error calling the Azure Function. Check console.");
      }
    });
  </script>
</body>
</html>